<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Observables in a reactive world | Ananthu Kanive</title>
<meta name="keywords" content="">
<meta name="description" content="Picture this: you&rsquo;re faced with the challenge of updating state from realms outside the familiar component tree. What was once a straightforward task within React&rsquo;s structured paradigm suddenly transforms into a complex puzzle. Traditional solutions falter, leaving React developers grappling with a dilemma that defies the simplicity promised by the framework.
As React developers, we love how easy it is to handle state inside our components. But things get a bit tricky when we need to update state from outside React&rsquo;s usual territory.">
<meta name="author" content="">
<link rel="canonical" href="https://lonelycpp.github.io/2023/11/15/observables-in-a-reactive-world/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lonelycpp.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://lonelycpp.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://lonelycpp.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://lonelycpp.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://lonelycpp.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-165995640-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script><meta property="og:title" content="Observables in a reactive world" />
<meta property="og:description" content="Picture this: you&rsquo;re faced with the challenge of updating state from realms outside the familiar component tree. What was once a straightforward task within React&rsquo;s structured paradigm suddenly transforms into a complex puzzle. Traditional solutions falter, leaving React developers grappling with a dilemma that defies the simplicity promised by the framework.
As React developers, we love how easy it is to handle state inside our components. But things get a bit tricky when we need to update state from outside React&rsquo;s usual territory." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lonelycpp.github.io/2023/11/15/observables-in-a-reactive-world/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-11-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-11-15T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Observables in a reactive world"/>
<meta name="twitter:description" content="Picture this: you&rsquo;re faced with the challenge of updating state from realms outside the familiar component tree. What was once a straightforward task within React&rsquo;s structured paradigm suddenly transforms into a complex puzzle. Traditional solutions falter, leaving React developers grappling with a dilemma that defies the simplicity promised by the framework.
As React developers, we love how easy it is to handle state inside our components. But things get a bit tricky when we need to update state from outside React&rsquo;s usual territory."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://lonelycpp.github.io/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Observables in a reactive world",
      "item": "https://lonelycpp.github.io/2023/11/15/observables-in-a-reactive-world/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Observables in a reactive world",
  "name": "Observables in a reactive world",
  "description": "Picture this: you\u0026rsquo;re faced with the challenge of updating state from realms outside the familiar component tree. What was once a straightforward task within React\u0026rsquo;s structured paradigm suddenly transforms into a complex puzzle. Traditional solutions falter, leaving React developers grappling with a dilemma that defies the simplicity promised by the framework.\nAs React developers, we love how easy it is to handle state inside our components. But things get a bit tricky when we need to update state from outside React\u0026rsquo;s usual territory.",
  "keywords": [
    
  ],
  "articleBody": "Picture this: you‚Äôre faced with the challenge of updating state from realms outside the familiar component tree. What was once a straightforward task within React‚Äôs structured paradigm suddenly transforms into a complex puzzle. Traditional solutions falter, leaving React developers grappling with a dilemma that defies the simplicity promised by the framework.\nAs React developers, we love how easy it is to handle state inside our components. But things get a bit tricky when we need to update state from outside React‚Äôs usual territory. The usual ways we handle this become less helpful, and a once-simple solution becomes more complicated.\nMost developers reach out to complicated global state libraries. But wait!\nThe Singleton Observable Pattern ‚ú® The ‚ÄúSingleton Observable Pattern‚Äù is a variation of the Observer pattern where a single observable instance is shared and accessed globally within an application. In this pattern, there is a single source of truth for state changes, and multiple observers subscribe to this shared observable to receive updates.\nHere‚Äôs how it‚Äôll look when we‚Äôre done ü§å\n// BankBalanceUtils.js import { userState } from \"./userState\"; function bankBalanceUpdater() { // directly update property // updates are immediately reflected in the UI ü§Ø userState.funds += 100; } // BankBalance.jsx import { useUserState } from \"./userState\"; const BankBalance = () =\u003e { const user = useUserState(); return ( \u003c\u003e \u003cbutton onClick={() =\u003e { // directly update property user.funds += 100; }} \u003e create money \u003c/button\u003e {/* UI reacts to changes in user ü§Ø */} \u003cp\u003eyour funds : {user.funds}\u003c/p\u003e \u003c/\u003e ); }; Creating an Observable Singleton Creating a singleton class to store data In the heart of our pattern lies a state object, encapsulating the data we want to observe. Utilizing JavaScript‚Äôs class syntax, we establish a singleton instance for managing state changes across our application.\nIdentify the properties within the SingletonObservable class that you want to observe. These could be the critical pieces of data that, when changed, should trigger reactions across your application.\nclass UserState { static instance = null; #observers = []; #funds = 0; #name = \"\"; constructor() { if (UserState.instance) { return UserState.instance; } UserState.instance = this; } } Writing Getters and Setters for Observing Properties By employing getters and setters, we intercept the usage of these properties. The get method allows access to the state, while the set method not only updates the state but also triggers the notification process.\nclass UserState { // Previous code... get funds() { return this.#funds; } set funds(newFunds) { this.#funds = newFunds; this.notify(); } get name() { return this.#name; } set name(newName) { this.#name = newName; this.notify(); } } Adding Observable Callbacks for Property Changes: The magic happens in the notify method. Whenever a property undergoes a change, this method iterates through all registered observers, invoking their update methods and providing them with the updated state.\nclass UserState { // Previous code... subscribe(callBackFn) { this.#observers.push(callBackFn); // returns a function that can be called to unsubscribe from updates return () =\u003e this.unsubscribe(callBackFn); } notify() { this.#observers.forEach((callBackFn) =\u003e { callBackFn(); }); } } Singleton UserState Instance Ensure there‚Äôs a single instance of UserState that components can access globally. This instance will be created once and used throughout the application.\nclass UserState { // ... (previous UserState implementation) } // Create a singleton instance of UserState const userState = new UserState(); // Export the instance for use in the hook export default userState; Create the React Hook for Subscription import { useEffect } from \"react\"; import userState from \"./path-to-your-userstate-file\"; // Custom hook to subscribe to UserState changes export const useUserState = (callback) =\u003e { const [user, setUser] = useState(userState); useEffect(() =\u003e { const unsubscribe = userState.subscribe(() =\u003e { setUser(userState); }); userState.subscribe(observer); return () =\u003e { unsubscribe(); }; }, []); }; By following this approach, you maintain a global state accessible through a singleton instance of UserState. The custom hook, useUserState(), facilitates easy subscription to state changes within React components, ensuring a reactive and straightforward approach to managing global state.\nFinal Thoughts To sum it up, the way we‚Äôve organized state in React using the Observable Singleton pattern with getters and setters is like having a neat and tidy package.\nAlthough manually setting up getters and setters has some downsides, the cool part is that this method is all self-contained ‚Äì no need for external tools or libraries!\nThis example provides a straightforward introduction to the Observable Singleton pattern in React, but there‚Äôs room for improvement and customization. It‚Äôs intentionally kept simple, leaving ample space for readers to innovate and tailor the approach to their specific application needs.\nP.S\n(bonus reading) : Automate getters and setters using Proxies in javascript\nI‚Äôve used the class syntax in the code examples above because I think they look cleaner. We can use plain objects with getters and setters to achieve the same behavior.\n",
  "wordCount" : "798",
  "inLanguage": "en",
  "datePublished": "2023-11-15T00:00:00Z",
  "dateModified": "2023-11-15T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lonelycpp.github.io/2023/11/15/observables-in-a-reactive-world/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ananthu Kanive",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lonelycpp.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lonelycpp.github.io/" accesskey="h" title="Ananthu Kanive (Alt + H)">Ananthu Kanive</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://github.com/LonelyCpp" title="Projects">
                    <span>Projects</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://linkedin.com/in/ananthu-kanive-18376b61/" title="Contact">
                    <span>Contact</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Observables in a reactive world
    </h1>
    <div class="post-meta"><span title='2023-11-15 00:00:00 +0000 UTC'>Wed, Nov 15, 2023</span>

</div>
  </header> 
  <div class="post-content"><p>Picture this: you&rsquo;re faced with the challenge of updating state from realms outside the familiar component tree. What was once a straightforward task within React&rsquo;s structured paradigm suddenly transforms into a complex puzzle. Traditional solutions falter, leaving React developers grappling with a dilemma that defies the simplicity promised by the framework.</p>
<p>As React developers, we love how easy it is to handle state inside our components. But things get a bit tricky when we need to update state from outside React&rsquo;s usual territory. The usual ways we handle this become less helpful, and a once-simple solution becomes more complicated.</p>
<p>Most developers reach out to complicated global state libraries. But wait!</p>
<h2 id="the-singleton-observable-pattern-">The Singleton Observable Pattern ‚ú®<a hidden class="anchor" aria-hidden="true" href="#the-singleton-observable-pattern-">#</a></h2>
<p>The <em>&ldquo;Singleton Observable Pattern&rdquo;</em> is a variation of the Observer pattern where a single observable instance is shared and accessed globally within an application. In this pattern, there is a single source of truth for state changes, and multiple observers subscribe to this shared observable to receive updates.</p>
<p><img loading="lazy" src="/obs/osp_flow.png" alt="screenshot"  />
</p>
<p>Here‚Äôs how it‚Äôll look when we&rsquo;re done ü§å</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="c1">// BankBalanceUtils.js
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">userState</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;./userState&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">bankBalanceUpdater</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// directly update property
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// updates are immediately reflected in the UI ü§Ø
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">userState</span><span class="p">.</span><span class="nx">funds</span> <span class="o">+=</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// BankBalance.jsx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">useUserState</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;./userState&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">BankBalance</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">useUserState</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">button</span>
</span></span><span class="line"><span class="cl">        <span class="na">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="c1">// directly update property
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="nx">user</span><span class="p">.</span><span class="nx">funds</span> <span class="o">+=</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}}</span>
</span></span><span class="line"><span class="cl">      <span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">create</span> <span class="nx">money</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="cm">/* UI reacts to changes in user ü§Ø */</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">your</span> <span class="nx">funds</span> <span class="o">:</span> <span class="p">{</span><span class="nx">user</span><span class="p">.</span><span class="nx">funds</span><span class="p">}&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><h2 id="creating-an-observable-singleton">Creating an Observable Singleton<a hidden class="anchor" aria-hidden="true" href="#creating-an-observable-singleton">#</a></h2>
<ol>
<li>Creating a singleton class to store data</li>
</ol>
<p>In the heart of our pattern lies a state object, encapsulating the data we want to observe. Utilizing JavaScript&rsquo;s class syntax, we establish a singleton instance for managing state changes across our application.</p>
<p>Identify the properties within the SingletonObservable class that you want to observe. These could be the critical pieces of data that, when changed, should trigger reactions across your application.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">UserState</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">static</span> <span class="nx">instance</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="err">#</span><span class="nx">observers</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="err">#</span><span class="nx">funds</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="err">#</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">UserState</span><span class="p">.</span><span class="nx">instance</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">UserState</span><span class="p">.</span><span class="nx">instance</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">UserState</span><span class="p">.</span><span class="nx">instance</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ol start="2">
<li>Writing Getters and Setters for Observing Properties</li>
</ol>
<p>By employing getters and setters, we intercept the usage of these properties. The get method allows access to the state, while the set method not only updates the state but also triggers the notification process.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">UserState</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// Previous code...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nx">get</span> <span class="nx">funds</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">funds</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">set</span> <span class="nx">funds</span><span class="p">(</span><span class="nx">newFunds</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">funds</span> <span class="o">=</span> <span class="nx">newFunds</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">notify</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">get</span> <span class="nx">name</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">set</span> <span class="nx">name</span><span class="p">(</span><span class="nx">newName</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">newName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">notify</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ol start="3">
<li>Adding Observable Callbacks for Property Changes:</li>
</ol>
<p>The magic happens in the notify method. Whenever a property undergoes a change, this method iterates through all registered observers, invoking their update methods and providing them with the updated state.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">UserState</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// Previous code...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nx">subscribe</span><span class="p">(</span><span class="nx">callBackFn</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">observers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">callBackFn</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// returns a function that can be called to unsubscribe from updates
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">(</span><span class="nx">callBackFn</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">notify</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">observers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">callBackFn</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">callBackFn</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ol start="4">
<li>Singleton UserState Instance</li>
</ol>
<p>Ensure there&rsquo;s a single instance of UserState that components can access globally. This instance will be created once and used throughout the application.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">UserState</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ... (previous UserState implementation)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Create a singleton instance of UserState
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">userState</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UserState</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Export the instance for use in the hook
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">userState</span><span class="p">;</span>
</span></span></code></pre></div><h2 id="create-the-react-hook-for-subscription">Create the React Hook for Subscription<a hidden class="anchor" aria-hidden="true" href="#create-the-react-hook-for-subscription">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;react&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">userState</span> <span class="nx">from</span> <span class="s2">&#34;./path-to-your-userstate-file&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Custom hook to subscribe to UserState changes
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">useUserState</span> <span class="o">=</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">[</span><span class="nx">user</span><span class="p">,</span> <span class="nx">setUser</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="nx">userState</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">useEffect</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">unsubscribe</span> <span class="o">=</span> <span class="nx">userState</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">setUser</span><span class="p">(</span><span class="nx">userState</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">userState</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">unsubscribe</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span> <span class="p">[]);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><p>By following this approach, you maintain a global state accessible through a singleton instance of UserState. The custom hook, <code>useUserState()</code>, facilitates easy subscription to state changes within React components, ensuring a reactive and straightforward approach to managing global state.</p>
<h2 id="final-thoughts">Final Thoughts<a hidden class="anchor" aria-hidden="true" href="#final-thoughts">#</a></h2>
<p>To sum it up, the way we&rsquo;ve organized state in React using the Observable Singleton pattern with getters and setters is like having a neat and tidy package.</p>
<p>Although manually setting up getters and setters has some downsides, the cool part is that this method is all self-contained ‚Äì no need for external tools or libraries!</p>
<p>This example provides a straightforward introduction to the Observable Singleton pattern in React, but there&rsquo;s room for improvement and customization. It&rsquo;s intentionally kept simple, leaving ample space for readers to innovate and tailor the approach to their specific application needs.</p>
<hr>
<p><em>P.S</em></p>
<ul>
<li>
<p>(bonus reading) : Automate getters and setters using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy">Proxies</a> in javascript</p>
</li>
<li>
<p>I&rsquo;ve used the <em>class</em> syntax in the code examples above because I think they look cleaner. We can use plain objects with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/get">getters</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/set">setters</a> to achieve the same behavior.</p>
</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>Ananthu P Kanive</span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
